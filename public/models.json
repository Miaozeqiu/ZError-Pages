[
  {
    "baseUrl": "https://api.siliconflow.cn/v1/chat/completions",
    "description": "硅基流动AI平台服务",
    "displayName": "硅基流动",
    "icon": "silicon.png",
    "id": "siliconflow",
    "models": [
      {
        "category": "text",
        "description": "DeepSeek-V3 高性能大语言模型",
        "displayName": "DeepSeek-V3",
        "enabled": true,
        "id": "siliconflow-deepseek-v3",
        "jsCode": "async function processModel(input, config, abortSignal) { \n   // 构建请求数据 \n   const requestData = { \n     messages: input.messages, \n     model: 'deepseek-ai/DeepSeek-V3', \n     stream: true, \n     max_tokens: 4096, \n     temperature: 0.7, \n     top_p:0.9 \n   }; \n   \n   console.log('SiliconFlow 请求:', requestData); \n   \n   try { \n     // 发送请求到SiliconFlow API \n     const response = await fetch(`${config.baseUrl}`, { \n       method: 'POST', \n       headers: { \n         'Authorization': `Bearer ${config.apiKey}`, \n         'Content-Type': 'application/json' \n       }, \n       body: JSON.stringify(requestData),\n       signal: abortSignal\n     }); \n     \n     if (!response.ok) { \n       const errorText = await response.text(); \n       throw new Error(`SiliconFlow API 错误 ${response.status}: ${errorText}`); \n     } \n     \n     // 处理流式响应 \n     const reader = response.body.getReader(); \n     const decoder = new TextDecoder(); \n     \n     // 返回异步生成器处理流式数据 \n     return (async function* () { \n       let buffer = ''; \n       \n       try { \n         while (true) { \n           const { done, value } = await reader.read(); \n           \n           if (done) { \n             break; \n           } \n           \n           // 解码数据块 \n           buffer += decoder.decode(value, { stream: true }); \n           const lines = buffer.split('\\n'); \n           buffer = lines.pop() || ''; \n           \n           for (const line of lines) { \n             const trimmedLine = line.trim(); \n             if (trimmedLine === '' || trimmedLine === 'data: [DONE]') { \n               continue; \n             } \n             \n             if (trimmedLine.startsWith('data: ')) { \n               try { \n                 const jsonStr = trimmedLine.slice(6); \n                 const data = JSON.parse(jsonStr); \n                 \n                 if (data.choices && data.choices[0] && data.choices[0].delta) { \n                   const content = data.choices[0].delta.content || ''; \n                   const finished = data.choices[0].finish_reason === 'stop'; \n                   \n                   if (content || finished) { \n                     yield { \n                       content: content, \n                       finished: finished \n                     }; \n                   } \n                 } \n               } catch (parseError) { \n                 console.warn('解析SSE数据失败:', parseError, trimmedLine); \n               } \n             } \n           } \n         } \n       } finally { \n         reader.releaseLock(); \n       } \n     })(); \n     \n   } catch (error) { \n     console.error('SiliconFlow API 调用失败:', error); \n     throw error; \n   } \n }",
        "maxTokens": 4096,
        "name": "siliconflow-deepseek-ai/DeepSeek-V3",
        "platformId": "siliconflow",
        "pricing": {
          "inputTokens": 0.002,
          "outputTokens": 0.006
        },
        "temperature": 0.7,
        "topP": 0.9
      },
      {
        "category": "text",
        "description": "2025/09/22 发布DeepSeek-V3升级版",
        "displayName": "DeepSeek-V3.1-Terminus",
        "enabled": true,
        "id": "siliconflow-deepseek-v31-terminus",
        "jsCode": "async function processModel(input, config, abortSignal) { \n    // 构建请求数据 \n    const requestData = { \n      messages: input.messages, \n      model: 'deepseek-ai/DeepSeek-V3.1-Terminus', \n      stream: true, \n      max_tokens: 4096, \n      temperature: 0.7, \n      top_p:0.9 \n    }; \n    \n    console.log('SiliconFlow DeepSeek-V3.1-Terminus 请求:', requestData); \n    \n    try { \n      // 发送请求到SiliconFlow API \n      const response = await fetch(`${config.baseUrl}`, { \n        method: 'POST', \n        headers: { \n          'Authorization': `Bearer ${config.apiKey}`, \n          'Content-Type': 'application/json' \n        }, \n        body: JSON.stringify(requestData),\n        signal: abortSignal\n      }); \n      \n      if (!response.ok) { \n        const errorText = await response.text(); \n        throw new Error(`SiliconFlow DeepSeek-V3.1-Terminus API 错误 ${response.status}: ${errorText}`); \n      } \n      \n      // 处理流式响应 \n      const reader = response.body.getReader(); \n      const decoder = new TextDecoder(); \n      \n      // 返回异步生成器处理流式数据 \n      return (async function* () { \n        let buffer = ''; \n        \n        try { \n          while (true) { \n            const { done, value } = await reader.read(); \n            \n            if (done) { \n              break; \n            } \n            \n            // 解码数据块 \n            buffer += decoder.decode(value, { stream: true }); \n            const lines = buffer.split('\\n'); \n            buffer = lines.pop() || ''; \n            \n            for (const line of lines) { \n              const trimmedLine = line.trim(); \n              if (trimmedLine === '' || trimmedLine === 'data: [DONE]') { \n                continue; \n              } \n              \n              if (trimmedLine.startsWith('data: ')) { \n                try { \n                  const jsonStr = trimmedLine.slice(6); \n                  const data = JSON.parse(jsonStr); \n                  \n                  if (data.choices && data.choices[0] && data.choices[0].delta) { \n                    const content = data.choices[0].delta.content || ''; \n                    const finished = data.choices[0].finish_reason === 'stop'; \n                    \n                    if (content || finished) { \n                      yield { \n                        content: content, \n                        finished: finished \n                      }; \n                    } \n                  } \n                } catch (parseError) { \n                  console.warn('解析SSE数据失败:', parseError, trimmedLine); \n                } \n              } \n            } \n          } \n        } finally { \n          reader.releaseLock(); \n        } \n      })(); \n      \n    } catch (error) { \n      console.error('SiliconFlow DeepSeek-V3.1-Terminus API 调用失败:', error); \n      throw error; \n    } \n  }",
        "maxTokens": 4096,
        "name": "siliconflow-deepseek-ai/DeepSeek-V3.1-Terminus",
        "platformId": "siliconflow",
        "pricing": {
          "inputTokens": 0.002,
          "outputTokens": 0.006
        },
        "temperature": 0.7,
        "topP": 0.9
      },
      {
        "category": "text",
        "description": "Kimi-K2-Instruct 高性能对话模型，支持长文本理解",
        "displayName": "Kimi-K2-Instruct",
        "enabled": true,
        "id": "siliconflow-kimi-k2-instruct",
        "jsCode": "async function processModel(input, config, abortSignal) { \n    // 构建请求数据 \n    const requestData = { \n      messages: input.messages, \n      model: 'moonshotai/Kimi-K2-Instruct-0905', \n      stream: true, \n      max_tokens: 4096, \n      temperature: 0.7, \n      top_p:0.9 \n    }; \n    \n    console.log('SiliconFlow Kimi 请求:', requestData); \n    \n    try { \n      // 发送请求到SiliconFlow API \n      const response = await fetch(`${config.baseUrl}`, { \n        method: 'POST', \n        headers: { \n          'Authorization': `Bearer ${config.apiKey}`, \n          'Content-Type': 'application/json' \n        }, \n        body: JSON.stringify(requestData),\n        signal: abortSignal\n      }); \n      \n      if (!response.ok) { \n        const errorText = await response.text(); \n        throw new Error(`SiliconFlow Kimi API 错误 ${response.status}: ${errorText}`); \n      } \n      \n      // 处理流式响应 \n      const reader = response.body.getReader(); \n      const decoder = new TextDecoder(); \n      \n      // 返回异步生成器处理流式数据 \n      return (async function* () { \n        let buffer = ''; \n        \n        try { \n          while (true) { \n            const { done, value } = await reader.read(); \n            \n            if (done) { \n              break; \n            } \n            \n            // 解码数据块 \n            buffer += decoder.decode(value, { stream: true }); \n            const lines = buffer.split('\\n'); \n            buffer = lines.pop() || ''; \n            \n            for (const line of lines) { \n              const trimmedLine = line.trim(); \n              if (trimmedLine === '' || trimmedLine === 'data: [DONE]') { \n                continue; \n              } \n              \n              if (trimmedLine.startsWith('data: ')) { \n                try { \n                  const jsonStr = trimmedLine.slice(6); \n                  const data = JSON.parse(jsonStr); \n                  \n                  if (data.choices && data.choices[0] && data.choices[0].delta) { \n                    const content = data.choices[0].delta.content || ''; \n                    const finished = data.choices[0].finish_reason === 'stop'; \n                    \n                    if (content || finished) { \n                      yield { \n                        content: content, \n                        finished: finished \n                      }; \n                    } \n                  } \n                } catch (parseError) { \n                  console.warn('解析SSE数据失败:', parseError, trimmedLine); \n                } \n              } \n            } \n          } \n        } finally { \n          reader.releaseLock(); \n        } \n      })(); \n      \n    } catch (error) { \n      console.error('SiliconFlow Kimi API 调用失败:', error); \n      throw error; \n    } \n  }",
        "maxTokens": 4096,
        "name": "siliconflow-moonshotai/Kimi-K2-Instruct-0905",
        "platformId": "siliconflow",
        "pricing": {
          "inputTokens": 0.001,
          "outputTokens": 0.003
        },
        "temperature": 0.7,
        "topP": 0.9
      },
      {
        "category": "vision",
        "description": "Qwen2.5-VL-72B 视觉语言模型，支持图像理解和分析",
        "displayName": "Qwen2.5-VL-72B",
        "enabled": true,
        "id": "siliconflow-qwen2-vl-72b",
        "jsCode": "async function processModel(input, config, abortSignal) {\n    // 构建请求数据，支持视觉输入\n    const requestData = {\n      messages: input.messages,\n      model: 'Qwen/Qwen2.5-VL-72B-Instruct',\n      stream: true,\n      max_tokens: 4096,\n      temperature: 0.7,\n      top_p: 0.9\n    };\n    \n    console.log('SiliconFlow VLM 请求:', requestData);\n    \n    try {\n      // 发送请求到SiliconFlow API\n      const response = await fetch(`${config.baseUrl}`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${config.apiKey}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(requestData),\n        signal: abortSignal\n      });\n     \n     if (!response.ok) {\n       const errorText = await response.text();\n       throw new Error(`SiliconFlow VLM API 错误 ${response.status}: ${errorText}`);\n     }\n     \n     // 处理流式响应\n     const reader = response.body.getReader();\n     const decoder = new TextDecoder();\n     \n     // 返回异步生成器处理流式数据\n     return (async function* () {\n       let buffer = '';\n       \n       try {\n         while (true) {\n           const { done, value } = await reader.read();\n           \n           if (done) {\n             break;\n           }\n           \n           // 解码数据块\n           buffer += decoder.decode(value, { stream: true });\n           const lines = buffer.split('\\n');\n           buffer = lines.pop() || '';\n           \n           for (const line of lines) {\n             const trimmedLine = line.trim();\n             if (trimmedLine === '' || trimmedLine === 'data: [DONE]') {\n               continue;\n             }\n             \n             if (trimmedLine.startsWith('data: ')) {\n               try {\n                 const jsonStr = trimmedLine.slice(6);\n                 const data = JSON.parse(jsonStr);\n                 \n                 if (data.choices && data.choices[0] && data.choices[0].delta) {\n                   const content = data.choices[0].delta.content || '';\n                   const finished = data.choices[0].finish_reason === 'stop';\n                   \n                   if (content || finished) {\n                     yield {\n                       content: content,\n                       finished: finished\n                     };\n                   }\n                 }\n               } catch (parseError) {\n                 console.warn('解析SSE数据失败:', parseError, trimmedLine);\n               }\n             }\n           }\n         }\n       } finally {\n         reader.releaseLock();\n       }\n     })();\n     \n   } catch (error) {\n     console.error('SiliconFlow VLM API 调用失败:', error);\n     throw error;\n   }\n }",
        "maxTokens": 4096,
        "name": "siliconflow-Qwen/Qwen2.5-VL-72B-Instruct",
        "platformId": "siliconflow",
        "pricing": {
          "inputTokens": 0.004,
          "outputTokens": 0.012
        },
        "temperature": 0.7,
        "topP": 0.9
      },
      {
        "category": "vision",
        "description": "Qwen3-VL-32B 最新视觉语言模型，支持图像、视频理解",
        "displayName": "Qwen3-VL-32B",
        "enabled": true,
        "id": "siliconflow-qwen3-vl-32b",
        "jsCode": "async function processModel(input, config, abortSignal) {\n    // 构建请求数据，支持视觉输入\n    const requestData = {\n      messages: input.messages,\n      model: 'Qwen/Qwen3-VL-32B-Instruct',\n      stream: true,\n      max_tokens: 4096,\n      temperature: 0.7,\n      top_p: 0.9\n    };\n    \n    console.log('SiliconFlow Qwen3-VL 请求:', requestData);\n    \n    try {\n      // 发送请求到SiliconFlow API\n      const response = await fetch(`${config.baseUrl}`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${config.apiKey}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(requestData),\n        signal: abortSignal\n      });\n     \n     if (!response.ok) {\n       const errorText = await response.text();\n       throw new Error(`SiliconFlow Qwen3-VL API 错误 ${response.status}: ${errorText}`);\n     }\n     \n     // 处理流式响应\n     const reader = response.body.getReader();\n     const decoder = new TextDecoder();\n     \n     // 返回异步生成器处理流式数据\n     return (async function* () {\n       let buffer = '';\n       \n       try {\n         while (true) {\n           const { done, value } = await reader.read();\n           \n           if (done) {\n             break;\n           }\n           \n           // 解码数据块\n           buffer += decoder.decode(value, { stream: true });\n           const lines = buffer.split('\\n');\n           buffer = lines.pop() || '';\n           \n           for (const line of lines) {\n             const trimmedLine = line.trim();\n             if (trimmedLine === '' || trimmedLine === 'data: [DONE]') {\n               continue;\n             }\n             \n             if (trimmedLine.startsWith('data: ')) {\n               try {\n                 const jsonStr = trimmedLine.slice(6);\n                 const data = JSON.parse(jsonStr);\n                 \n                 if (data.choices && data.choices[0] && data.choices[0].delta) {\n                   const content = data.choices[0].delta.content || '';\n                   const finished = data.choices[0].finish_reason === 'stop';\n                   \n                   if (content || finished) {\n                     yield {\n                       content: content,\n                       finished: finished\n                     };\n                   }\n                 }\n               } catch (parseError) {\n                 console.warn('解析SSE数据失败:', parseError, trimmedLine);\n               }\n             }\n           }\n         }\n       } finally {\n         reader.releaseLock();\n       }\n     })();\n     \n   } catch (error) {\n     console.error('SiliconFlow Qwen3-VL API 调用失败:', error);\n     throw error;\n   }\n }",
        "maxTokens": 4096,
        "name": "siliconflow-Qwen/Qwen3-VL-32B-Instruct",
        "platformId": "siliconflow",
        "pricing": {
          "inputTokens": 0.003,
          "outputTokens": 0.009
        },
        "temperature": 0.7,
        "topP": 0.9
      },
      {
        "category": "text",
        "description": "DeepSeek-R1思考模型",
        "displayName": "DeepSeek-R1",
        "enabled": true,
        "id": "siliconflow-deepseek-r1",
        "jsCode": "async function processModel(input, config) {\n  // 构建请求数据\n  const requestData = {\n    messages: input.messages,\n    model: 'deepseek-ai/DeepSeek-R1',\n    stream: true,\n    max_tokens: 4096,\n    temperature: 0.7,\n    top_p: 0.9\n  };\n\n  console.log('SiliconFlow 请求:', requestData);\n\n  try {\n    // 发送请求到 SiliconFlow API\n    const response = await fetch(`${config.baseUrl}`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${config.apiKey}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(requestData)\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`SiliconFlow API 错误 ${response.status}: ${errorText}`);\n    }\n\n    // 处理流式响应\n    const reader = response.body.getReader();\n    const decoder = new TextDecoder();\n\n    // 返回异步生成器处理流式数据\n    return (async function* () {\n      let buffer = '';\n\n      try {\n        while (true) {\n          const { done, value } = await reader.read();\n\n          if (done) {\n            break;\n          }\n\n          // 解码数据块\n          buffer += decoder.decode(value, { stream: true });\n          const lines = buffer.split('\\n');\n          buffer = lines.pop() || '';\n\n          for (const line of lines) {\n            const trimmedLine = line.trim();\n\n            if (trimmedLine === '' || trimmedLine === 'data: [DONE]') {\n              continue;\n            }\n\n            if (trimmedLine.startsWith('data: ')) {\n              try {\n                const jsonStr = trimmedLine.slice(6);\n                const data = JSON.parse(jsonStr);\n\n                if (data.choices && data.choices[0] && data.choices[0].delta) {\n                  const delta = data.choices[0].delta;\n\n                  const content = delta.content ?? '';\n                  const reasoning_content = delta.reasoning_content ?? '';\n                  const finished = data.choices[0].finish_reason === 'stop';\n\n                  if (content || reasoning_content || finished) {\n                    yield {\n                      content,\n                      reasoning_content,       \n                      finished\n                    };\n                  }\n                }\n              } catch (parseError) {\n                console.warn('解析 SSE 数据失败:', parseError, trimmedLine);\n              }\n            }\n          }\n        }\n      } finally {\n        reader.releaseLock();\n      }\n    })();\n  } catch (error) {\n    console.error('SiliconFlow API 调用失败:', error);\n    throw error;\n  }\n}\n",
        "maxTokens": 4096,
        "name": "siliconflow-deepseek-ai/DeepSeek-R1",
        "platformId": "siliconflow",
        "pricing": {
          "inputTokens": 0,
          "outputTokens": 0
        },
        "temperature": 0.7,
        "topP": 0.9
      }
    ],
    "name": "siliconflow"
  },
  {
    "baseUrl": "https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions",
    "description": "阿里云百炼AI平台服务",
    "displayName": "阿里云百炼",
    "icon": "bailian.png",
    "id": "aliyun-bailian",
    "models": [
      {
        "category": "text",
        "description": "通义千问Plus 高性能大语言模型",
        "displayName": "通义千问Plus",
        "enabled": true,
        "id": "bailian-qwen-plus",
        "jsCode": "async function processModel(input, config) { \n   // 构建请求数据 \n   const requestData = { \n     messages: input.messages, \n     model: 'qwen-plus', \n     stream: true,\n   }; \n   \n   console.log('阿里云百炼 请求:', requestData); \n   \n   try { \n     // 发送请求到阿里云百炼 API \n     const response = await fetch(`${config.baseUrl}`, { \n       method: 'POST', \n       headers: { \n         'Authorization': `Bearer ${config.apiKey}`, \n         'Content-Type': 'application/json' \n       }, \n       body: JSON.stringify(requestData) \n     }); \n     \n     if (!response.ok) { \n       const errorText = await response.text(); \n       throw new Error(`阿里云百炼 API 错误 ${response.status}: ${errorText}`); \n     } \n     \n     // 处理流式响应 \n     const reader = response.body.getReader(); \n     const decoder = new TextDecoder(); \n     \n     // 返回异步生成器处理流式数据 \n     return (async function* () { \n       let buffer = ''; \n       \n       try { \n         while (true) { \n           const { done, value } = await reader.read(); \n           \n           if (done) { \n             break; \n           } \n           \n           // 解码数据块 \n           buffer += decoder.decode(value, { stream: true }); \n           const lines = buffer.split('\\n'); \n           buffer = lines.pop() || ''; \n           \n           for (const line of lines) { \n             const trimmedLine = line.trim(); \n             if (trimmedLine === '' || trimmedLine === 'data: [DONE]') { \n               continue; \n             } \n             \n             if (trimmedLine.startsWith('data: ')) { \n               try { \n                 const jsonStr = trimmedLine.slice(6); \n                 const data = JSON.parse(jsonStr); \n                 \n                 if (data.choices && data.choices[0] && data.choices[0].delta) { \n                   const content = data.choices[0].delta.content || ''; \n                   const finished = data.choices[0].finish_reason === 'stop'; \n                   \n                   if (content || finished) { \n                     yield { \n                       content: content, \n                       finished: finished \n                     }; \n                   } \n                 } \n               } catch (parseError) { \n                 console.warn('解析SSE数据失败:', parseError, trimmedLine); \n               } \n             } \n           } \n         } \n       } finally { \n         reader.releaseLock(); \n       } \n     })(); \n     \n   } catch (error) { \n     console.error('阿里云百炼 API 调用失败:', error); \n     throw error; \n   } \n }",
        "maxTokens": 4096,
        "name": "bailian-qwen-plus",
        "platformId": "aliyun-bailian",
        "pricing": {
          "inputTokens": 0.004,
          "outputTokens": 0.012
        },
        "temperature": 0.7,
        "topP": 0.9
      },
      {
        "category": "text",
        "description": "通义千问3-Max 高性能大语言模型 导入题目时建议试试这个",
        "displayName": "通义千问3-Max",
        "enabled": true,
        "id": "bailian-qwen3-max",
        "jsCode": "async function processModel(input, config, abortSignal) {\n  // 构建请求数据\n  const requestData = {\n    messages: input.messages,\n    model: 'qwen3-max',\n    stream: true,\n  };\n\n  // 如果有工具定义，添加到请求中\n  if (input.tools && input.tools.length > 0) {\n    requestData.tools = input.tools;\n    // 可选：设置工具调用模式 ('auto' | 'none' | 'required')\n    if (input.tool_choice) {\n      requestData.tool_choice = input.tool_choice;\n    }\n  }\n\n  console.log('阿里云百炼 Qwen3-Max 请求:', requestData);\n\n  try {\n    // 发送请求到阿里云百炼 API\n    const response = await fetch(`${config.baseUrl}`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${config.apiKey}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(requestData),\n      signal: abortSignal\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`阿里云百炼 Qwen3-Max API 错误 ${response.status}: ${errorText}`);\n    }\n\n    // 处理流式响应\n    const reader = response.body.getReader();\n    const decoder = new TextDecoder();\n\n    // 返回异步生成器处理流式数据\n    return (async function* () {\n      let buffer = '';\n      let toolCalls = []; // 累积工具调用\n\n      try {\n        while (true) {\n          const { done, value } = await reader.read();\n\n          if (done) {\n            break;\n          }\n\n          // 解码数据块\n          buffer += decoder.decode(value, { stream: true });\n          const lines = buffer.split('\\n');\n          buffer = lines.pop() || '';\n\n          for (const line of lines) {\n            const trimmedLine = line.trim();\n            if (trimmedLine === '' || trimmedLine === 'data: [DONE]') {\n              continue;\n            }\n\n            if (trimmedLine.startsWith('data: ')) {\n              try {\n                const jsonStr = trimmedLine.slice(6);\n                const data = JSON.parse(jsonStr);\n\n                if (data.choices && data.choices[0]) {\n                  const choice = data.choices[0];\n                  const delta = choice.delta || {};\n                  const finished = choice.finish_reason === 'stop' || choice.finish_reason === 'tool_calls';\n\n                  // 处理普通文本内容\n                  if (delta.content) {\n                    yield {\n                      content: delta.content,\n                      finished: false,\n                      type: 'text'\n                    };\n                  }\n\n                  // 处理工具调用（流式）\n                  if (delta.tool_calls && Array.isArray(delta.tool_calls)) {\n                    for (const toolCall of delta.tool_calls) {\n                      const index = toolCall.index || 0;\n\n                      // 初始化工具调用对象\n                      if (!toolCalls[index]) {\n                        toolCalls[index] = {\n                          id: toolCall.id || '',\n                          type: toolCall.type || 'function',\n                          function: {\n                            name: toolCall.function?.name || '',\n                            arguments: ''\n                          }\n                        };\n                      }\n\n                      // 累积参数\n                      if (toolCall.function?.arguments) {\n                        toolCalls[index].function.arguments += toolCall.function.arguments;\n                      }\n\n                      // 更新其他字段\n                      if (toolCall.id) {\n                        toolCalls[index].id = toolCall.id;\n                      }\n                      if (toolCall.function?.name) {\n                        toolCalls[index].function.name = toolCall.function.name;\n                      }\n                    }\n                  }\n\n                  // 如果完成，返回最终结果\n                  if (finished) {\n                    // 如果有工具调用，返回工具调用信息\n                    if (toolCalls.length > 0) {\n                      // 解析所有工具调用的参数\n                      const parsedToolCalls = toolCalls.map(tc => ({\n                        ...tc,\n                        function: {\n                          ...tc.function,\n                          arguments: tc.function.arguments ? JSON.parse(tc.function.arguments) : {}\n                        }\n                      }));\n\n                      yield {\n                        content: '',\n                        finished: true,\n                        type: 'tool_calls',\n                        tool_calls: parsedToolCalls,\n                        finish_reason: 'tool_calls'\n                      };\n                    } else {\n                      // 普通文本完成\n                      yield {\n                        content: '',\n                        finished: true,\n                        type: 'text',\n                        finish_reason: 'stop'\n                      };\n                    }\n                  }\n                }\n              } catch (parseError) {\n                console.warn('解析SSE数据失败:', parseError, trimmedLine);\n              }\n            }\n          }\n        }\n      } finally {\n        reader.releaseLock();\n      }\n    })();\n\n  } catch (error) {\n    console.error('阿里云百炼 Qwen3-Max API 调用失败:', error);\n    throw error;\n  }\n}",
        "maxTokens": 4096,
        "name": "bailian-qwen3-max",
        "platformId": "aliyun-bailian",
        "pricing": {
          "inputTokens": 0.004,
          "outputTokens": 0.012
        },
        "temperature": 0.7,
        "topP": 0.9
      },
      {
        "category": "vision",
        "description": "通义千问3-VL-Plus 视觉语言模型，支持图像理解和分析",
        "displayName": "通义千问3-VL-Plus",
        "enabled": true,
        "id": "bailian-qwen3-vl-plus",
        "jsCode": "async function processModel(input, config, abortSignal) { \n    // 构建请求数据，支持视觉输入 \n    const requestData = { \n      messages: input.messages, \n      model: 'qwen3-vl-plus', \n      stream: true, \n      max_tokens: 4096, \n      temperature: 0.7, \n      top_p: 0.9 \n    }; \n    \n    console.log('阿里云百炼 Qwen3-VL 请求:', requestData); \n    \n    try { \n      // 发送请求到阿里云百炼 API \n      const response = await fetch(`${config.baseUrl}`, { \n        method: 'POST', \n        headers: { \n          'Authorization': `Bearer ${config.apiKey}`, \n          'Content-Type': 'application/json' \n        }, \n        body: JSON.stringify(requestData),\n        signal: abortSignal\n      }); \n      \n      if (!response.ok) { \n        const errorText = await response.text(); \n        throw new Error(`阿里云百炼 Qwen3-VL API 错误 ${response.status}: ${errorText}`); \n      } \n      \n      // 处理流式响应 \n      const reader = response.body.getReader(); \n      const decoder = new TextDecoder(); \n      \n      // 返回异步生成器处理流式数据 \n      return (async function* () { \n        let buffer = ''; \n        \n        try { \n          while (true) { \n            const { done, value } = await reader.read(); \n            \n            if (done) { \n              break; \n            } \n            \n            // 解码数据块 \n            buffer += decoder.decode(value, { stream: true }); \n            const lines = buffer.split('\\n'); \n            buffer = lines.pop() || ''; \n            \n            for (const line of lines) { \n              const trimmedLine = line.trim(); \n              if (trimmedLine === '' || trimmedLine === 'data: [DONE]') { \n                continue; \n              } \n              \n              if (trimmedLine.startsWith('data: ')) { \n                try { \n                  const jsonStr = trimmedLine.slice(6); \n                  const data = JSON.parse(jsonStr); \n                  \n                  if (data.choices && data.choices[0] && data.choices[0].delta) { \n                    const content = data.choices[0].delta.content || ''; \n                    const finished = data.choices[0].finish_reason === 'stop'; \n                    \n                    if (content || finished) { \n                      yield { \n                        content: content, \n                        finished: finished \n                      }; \n                    } \n                  } \n                } catch (parseError) { \n                  console.warn('解析SSE数据失败:', parseError, trimmedLine); \n                } \n              } \n            } \n          } \n        } finally { \n          reader.releaseLock(); \n        } \n      })(); \n      \n    } catch (error) { \n      console.error('阿里云百炼 Qwen3-VL API 调用失败:', error); \n      throw error; \n    } \n  }",
        "maxTokens": 4096,
        "name": "qwen3-vl-plus",
        "platformId": "aliyun-bailian",
        "pricing": {
          "inputTokens": 0.006,
          "outputTokens": 0.018
        },
        "temperature": 0.7,
        "topP": 0.9
      },
      {
        "category": "text",
        "description": "",
        "displayName": "DeepSeek-V3",
        "enabled": true,
        "id": "bailian-deepseek-v3",
        "jsCode": "async function processModel(input, config) { \n   // 构建请求数据 \n   const requestData = { \n     messages: input.messages, \n     model: 'deepseek-v3', \nstream: true,\n   }; \n   \n   console.log('阿里云百炼 请求:', requestData); \n   \n   try { \n     // 发送请求到阿里云百炼 API \n     const response = await fetch(`${config.baseUrl}`, { \n       method: 'POST', \n       headers: { \n         'Authorization': `Bearer ${config.apiKey}`, \n         'Content-Type': 'application/json' \n       }, \n       body: JSON.stringify(requestData) \n     }); \n     \n     if (!response.ok) { \n       const errorText = await response.text(); \n       throw new Error(`阿里云百炼 API 错误 ${response.status}: ${errorText}`); \n     } \n     \n     // 处理流式响应 \n     const reader = response.body.getReader(); \n     const decoder = new TextDecoder(); \n     \n     // 返回异步生成器处理流式数据 \n     return (async function* () { \n       let buffer = ''; \n       \n       try { \n         while (true) { \n           const { done, value } = await reader.read(); \n           \n           if (done) { \n             break; \n           } \n           \n           // 解码数据块 \n           buffer += decoder.decode(value, { stream: true }); \n           const lines = buffer.split('\\n'); \n           buffer = lines.pop() || ''; \n           \n           for (const line of lines) { \n             const trimmedLine = line.trim(); \n             if (trimmedLine === '' || trimmedLine === 'data: [DONE]') { \n               continue; \n             } \n             \n             if (trimmedLine.startsWith('data: ')) { \n               try { \n                 const jsonStr = trimmedLine.slice(6); \n                 const data = JSON.parse(jsonStr); \n                 \n                 if (data.choices && data.choices[0] && data.choices[0].delta) { \n                   const content = data.choices[0].delta.content || ''; \n                   const finished = data.choices[0].finish_reason === 'stop'; \n                   \n                   if (content || finished) { \n                     yield { \n                       content: content, \n                       finished: finished \n                     }; \n                   } \n                 } \n               } catch (parseError) { \n                 console.warn('解析SSE数据失败:', parseError, trimmedLine); \n               } \n             } \n           } \n         } \n       } finally { \n         reader.releaseLock(); \n       } \n     })(); \n     \n   } catch (error) { \n     console.error('阿里云百炼 API 调用失败:', error); \n     throw error; \n   } \n }\n",
        "maxTokens": 4096,
        "name": "bailian-deepseek-v3",
        "platformId": "aliyun-bailian",
        "pricing": {
          "inputTokens": 0,
          "outputTokens": 0
        },
        "temperature": 0.7,
        "topP": 0.9
      },
      {
        "category": "text",
        "description": "",
        "displayName": "DeepSeek-R1",
        "enabled": true,
        "id": "bailian-deepseek-r1",
        "jsCode": "async function processModel(input, config) { \n   // 构建请求数据 \n   const requestData = { \n     messages: input.messages, \n     model: 'deepseek-r1-0528', \n     stream: true,\n   }; \n   \n   console.log('阿里云百炼 请求:', requestData); \n   \n   try { \n     // 发送请求到阿里云百炼 API \n     const response = await fetch(`${config.baseUrl}`, { \n       method: 'POST', \n       headers: { \n         'Authorization': `Bearer ${config.apiKey}`, \n         'Content-Type': 'application/json' \n       }, \n       body: JSON.stringify(requestData) \n     }); \n     \n     if (!response.ok) { \n       const errorText = await response.text(); \n       throw new Error(`阿里云百炼 API 错误 ${response.status}: ${errorText}`); \n     } \n     \n     // 处理流式响应 \n     const reader = response.body.getReader(); \n     const decoder = new TextDecoder(); \n     \n    // 返回异步生成器处理流式数据\n    return (async function* () {\n      let buffer = '';\n\n      try {\n        while (true) {\n          const { done, value } = await reader.read();\n\n          if (done) {\n            break;\n          }\n\n          // 解码数据块\n          buffer += decoder.decode(value, { stream: true });\n          const lines = buffer.split('\\n');\n          buffer = lines.pop() || '';\n\n          for (const line of lines) {\n            const trimmedLine = line.trim();\n\n            // === 调试：打印原始 SSE 行 ===\n            if (trimmedLine.startsWith('data: ')) {\n              console.log('Raw SSE chunk:', trimmedLine);\n            } else if (trimmedLine !== '') {\n              console.log('Raw non-data line:', trimmedLine);\n            }\n            // ========================================\n\n            if (trimmedLine === '' || trimmedLine === 'data: [DONE]') {\n              continue;\n            }\n\n            if (trimmedLine.startsWith('data: ')) {\n              try {\n                const jsonStr = trimmedLine.slice(6);\n                const data = JSON.parse(jsonStr);\n\n                if (data.choices && data.choices[0] && data.choices[0].delta) {\n                  const delta = data.choices[0].delta;\n\n                  // 同时获取 content 与 reasoning_content\n                  const content = delta.content ?? '';\n                  const reasoning_content = delta.reasoning_content ?? '';\n\n                  const finished = data.choices[0].finish_reason === 'stop';\n\n                  // 只要有任意内容或结束标记就 yield\n                  if (content || reasoning_content || finished) {\n                    yield {\n                      content,\n                      reasoning_content,        // ← 新增字段\n                      finished\n                    };\n                  }\n                }\n              } catch (parseError) {\n                console.warn('解析 SSE 数据失败:', parseError, trimmedLine);\n              }\n            }\n          }\n        }\n      } finally {\n        reader.releaseLock();\n      }\n    })();\n  } catch (error) {\n    console.error('阿里云百炼 调用失败:', error);\n    throw error;\n  }\n}\n",
        "maxTokens": 4096,
        "name": "bailian-deepseek-r1",
        "platformId": "aliyun-bailian",
        "pricing": {
          "inputTokens": 0,
          "outputTokens": 0
        },
        "temperature": 0.7,
        "topP": 0.9
      }
    ],
    "name": "aliyun-bailian"
  },
  {
    "baseUrl": "https://api.deepseek.com/chat/completions",
    "description": "DeepSeek官方开放平台",
    "displayName": "DeepSeek",
    "icon": "deepseek.png",
    "id": "deepseek",
    "models": [
      {
        "category": "text",
        "description": "DeepSeek最新的模型，非推理",
        "displayName": "DeepSeek-Chat",
        "enabled": true,
        "id": "deepseek-deepseek-chat",
        "jsCode": "async function processModel(input, config) { \n   // 构建请求数据 \n   const requestData = { \n     messages: input.messages, \n     model: 'deepseek-chat', \n     stream: true,\n   }; \n   \n   console.log('DeepSeek开放平台 请求:', requestData); \n   \n   try { \n     // 发送请求到DeepSeek开放平台 API \n     const response = await fetch(`${config.baseUrl}`, { \n       method: 'POST', \n       headers: { \n         'Authorization': `Bearer ${config.apiKey}`, \n         'Content-Type': 'application/json' \n       }, \n       body: JSON.stringify(requestData) \n     }); \n     \n     if (!response.ok) { \n       const errorText = await response.text(); \n       throw new Error(`DeepSeek开放平台 API 错误 ${response.status}: ${errorText}`); \n     } \n     \n     // 处理流式响应 \n     const reader = response.body.getReader(); \n     const decoder = new TextDecoder(); \n     \n     // 返回异步生成器处理流式数据 \n     return (async function* () { \n       let buffer = ''; \n       \n       try { \n         while (true) { \n           const { done, value } = await reader.read(); \n           \n           if (done) { \n             break; \n           } \n           \n           // 解码数据块 \n           buffer += decoder.decode(value, { stream: true }); \n           const lines = buffer.split('\\n'); \n           buffer = lines.pop() || ''; \n           \n           for (const line of lines) { \n             const trimmedLine = line.trim(); \n             if (trimmedLine === '' || trimmedLine === 'data: [DONE]') { \n               continue; \n             } \n             \n             if (trimmedLine.startsWith('data: ')) { \n               try { \n                 const jsonStr = trimmedLine.slice(6); \n                 const data = JSON.parse(jsonStr); \n                 \n                 if (data.choices && data.choices[0] && data.choices[0].delta) { \n                   const content = data.choices[0].delta.content || ''; \n                   const finished = data.choices[0].finish_reason === 'stop'; \n                   \n                   if (content || finished) { \n                     yield { \n                       content: content, \n                       finished: finished \n                     }; \n                   } \n                 } \n               } catch (parseError) { \n                 console.warn('解析SSE数据失败:', parseError, trimmedLine); \n               } \n             } \n           } \n         } \n       } finally { \n         reader.releaseLock(); \n       } \n     })(); \n     \n   } catch (error) { \n     console.error('DeepSeek开放平台 API 调用失败:', error); \n     throw error; \n   } \n }",
        "maxTokens": 4096,
        "name": "deepseek-deepseek-chat",
        "platformId": "deepseek",
        "pricing": {
          "inputTokens": 0,
          "outputTokens": 0
        },
        "temperature": 0.7,
        "topP": 0.9
      },
      {
        "category": "text",
        "description": "DeepSeek最新的思考模型",
        "displayName": "DeepSeek-Reasoner",
        "enabled": true,
        "id": "deepseek-deepseek-reasoner",
        "jsCode": "async function processModel(input, config) {\n  // 构建请求数据\n  const requestData = {\n    messages: input.messages,\n    model: 'deepseek-reasoner',\n    stream: true,\n  };\n\n  console.log('DeepSeek开放平台 请求:', requestData);\n\n  try {\n    // 发送请求到 DeepSeek开放平台 API\n    const response = await fetch(`${config.baseUrl}`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${config.apiKey}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(requestData)\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`SiliconFlow API 错误 ${response.status}: ${errorText}`);\n    }\n\n    // 处理流式响应\n    const reader = response.body.getReader();\n    const decoder = new TextDecoder();\n\n    // 返回异步生成器处理流式数据\n    return (async function* () {\n      let buffer = '';\n\n      try {\n        while (true) {\n          const { done, value } = await reader.read();\n\n          if (done) {\n            break;\n          }\n\n          // 解码数据块\n          buffer += decoder.decode(value, { stream: true });\n          const lines = buffer.split('\\n');\n          buffer = lines.pop() || '';\n\n          for (const line of lines) {\n            const trimmedLine = line.trim();\n\n            if (trimmedLine === '' || trimmedLine === 'data: [DONE]') {\n              continue;\n            }\n\n            if (trimmedLine.startsWith('data: ')) {\n              try {\n                const jsonStr = trimmedLine.slice(6);\n                const data = JSON.parse(jsonStr);\n\n                if (data.choices && data.choices[0] && data.choices[0].delta) {\n                  const delta = data.choices[0].delta;\n\n                  const content = delta.content ?? '';\n                  const reasoning_content = delta.reasoning_content ?? '';\n                  const finished = data.choices[0].finish_reason === 'stop';\n\n                  // 只要有任意内容或结束标记就 yield\n                  if (content || reasoning_content || finished) {\n                    yield {\n                      content,\n                      reasoning_content,       \n                      finished\n                    };\n                  }\n                }\n              } catch (parseError) {\n                console.warn('解析 SSE 数据失败:', parseError, trimmedLine);\n              }\n            }\n          }\n        }\n      } finally {\n        reader.releaseLock();\n      }\n    })();\n  } catch (error) {\n    console.error('DeepSeek开放平台 调用失败:', error);\n    throw error;\n  }\n}\n",
        "maxTokens": 4096,
        "name": "deepseek-deepseek-reasoner",
        "platformId": "deepseek",
        "pricing": {
          "inputTokens": 0,
          "outputTokens": 0
        },
        "temperature": 0.7,
        "topP": 0.9
      }
    ],
    "name": "deepseek"
  }
]